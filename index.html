<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>СамСобіШеф | Робота в Одесі</title>
  <meta name="description" content="СамСобіШеф — платформа для пошуку підробітку та виконавців в Одесі та області. Додавайте завдання, вказуйте телефон та ціну — і чекайте на відгуки!">
  <link rel="icon" type="image/png" href="https://i.ibb.co/HLc01jWL/22c6c8c1-5106-4955-bec9-7c071a2a41e3.png"/>
  <style>
    body {font-family: Arial,sans-serif; background:#f5f7fc; margin:0; padding:0;}
    .main-app {max-width:430px; margin:44px auto 0; padding:0 6px;}
    .logo {width:84px; display:block; margin:16px auto 18px; border-radius:22px;}
    .add-btn-main {background:#2b81f7; color:#fff; border:none; font-weight:700; font-size:1.14em; padding:12px 18px; border-radius:13px; margin:24px auto; display:block; box-shadow:0 2px 12px #d7e4f540; width:100%;transition:.25s;}
    .modal-bg {position:fixed;z-index:10;top:0;left:0;width:100vw;height:100vh;background:#0005;display:flex;align-items:center;justify-content:center;animation:fadeIn .7s;transition:.4s;opacity:0;pointer-events:none;}
    .modal-bg.show {opacity:1; pointer-events:all;}
    .modal-card {background:#fff; border-radius:17px; box-shadow:0 4px 28px #b1d6fc45; width:340px; padding:26px 18px 12px; text-align:left; animation:popin .5s;}
    @keyframes popin {0%{transform:scale(.9);opacity:0;}100%{transform:scale(1);opacity:1;}}
    .modal-card h2 {font-size:18px; margin:0 0 14px;}
    .modal-field {margin-bottom:16px;}
    .modal-field input, .modal-field textarea {width:100%; font-size:15px; padding:9px 9px; border-radius:8px; border:1px solid #d7e4f5; outline:none;}
    .modal-btns {display:flex;justify-content:flex-end;gap:15px;}
    .modal-btn {padding:10px 21px; font-size:15px; font-weight:700; border-radius:10px; border:none; background:#2186e7; color:#fff; cursor:pointer;}
    .modal-btn.cancel {background:#f0f0f0; color:#205;}
    .msg {padding:12px 9px; margin:19px 0; background:#fff4cc; border-radius:10px; color:#ae820c; text-align:center; font-size:1.13em; opacity:0; transition:.3s;}
    .msg.show {opacity:1;}
    .fadein {animation:fadeIn .8s;}
    @keyframes fadeIn {from{opacity:0;}to{opacity:1;}}
  </style>
</head>
<body>
  <div class="main-app fadein" id="main-app">
    <img src="https://i.ibb.co/HLc01jWL/22c6c8c1-5106-4955-bec9-7c071a2a41e3.png" class="logo" alt="logo"/>
    <button class="add-btn-main" id="add-btn">Додати оголошення</button>
  </div>
  <!-- Модалка додавання -->
  <div class="modal-bg" id="add-modal">
    <div class="modal-card">
      <h2>Додати оголошення</h2>
      <form id="add-form">
        <div class="modal-field"><textarea id="task-desc" placeholder="Опишіть завдання..." required minlength="10"></textarea></div>
        <div class="modal-field"><input type="number" min="0" id="task-price" placeholder="Ціна, грн" required></div>
        <div class="modal-field"><input type="tel" id="task-phone" placeholder="Телефон" required></div>
        <div class="modal-btns">
          <button type="button" class="modal-btn cancel" id="cancel-modal">Скасувати</button>
          <button type="submit" class="modal-btn">Відправити</button>
        </div>
      </form>
    </div>
  </div>
  <div class="msg" id="msg"></div>
  <script>
    // Укажи свой сервер (Cloudflare tunnel, например)
    const SERVER = 'https://internet-ahead-reviewed-bacterial.trycloudflare.com';

    function $(x) {return document.getElementById(x);}
    function showMsg(txt) {
      $('msg').textContent = txt;
      $('msg').classList.add('show');
      setTimeout(()=>{$('msg').classList.remove('show');},2700);
    }
    function validUAphone(phone) {
      let p = phone.replace(/\D/g, '');
      return (/^380\d{9}$/.test(p) || /^0\d{9}$/.test(p));
    }
    $('add-btn').onclick = ()=>{ $('add-modal').classList.add('show'); };
    $('cancel-modal').onclick = ()=>{ $('add-modal').classList.remove('show'); $('add-form').reset();};
    $('add-form').onsubmit = async function(e){
      e.preventDefault();
      let desc=$('task-desc').value.trim(),price=$('task-price').value.trim(),phone=$('task-phone').value.trim();
      if(desc.length<10)return showMsg('Опис має бути від 10 символів!');
      if(!validUAphone(phone))return showMsg('Телефон некоректний!');
      let payload = {desc, price, phone};
      let resp = await fetch(SERVER+'/tg_notify', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify(payload)
      });
      $('add-modal').classList.remove('show');$('add-form').reset();
      if ((await resp.json()).ok) showMsg('Ваше оголошення відправлено адміністратору!');
      else showMsg('Помилка сервера!');
    };
  </script>
</body>
</html>
